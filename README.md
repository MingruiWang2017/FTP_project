**要求**：

1. 用户加密认证;

2. 允许同时多用户登录;

3. 每个用户有自己的家目录，且只能访问自己的家目录;

4. 对用户进行磁盘配额，每个用户的可用空间不同;

5. 允许用户在ftp server上随意切换目录;

6. 允许用户查看当前目录下的文件;

7. 允许上传和下载文件，并保证文件的一致性md5;

8. 文件传输过程中显示进度条;

9. 支持文件的断点续传（高级功能）.



**需求分析**：

总体：服务器端与客户端之间使用json进行命令的传递，使用socketserver进行命令和数据的传输

1. 用户加密认证：服务器与客户端进行交互之前，首先用户要在客户端进行登录，服务器端进行验证。
    
    1). 客户端发送用户名、密码（或密码的md5值）；
    
    2). 服务器端查找用户信息，比对密码；(不使用数据库，将用户的信息以json格式保存在文件中)
    
    3). 若正确，返回登陆成功；若不正确，提示重试。
    
2. 允许多用户同时登录：
    即要求支持多并发处理，这里使用socketserver的多线程支持ThreadingTCPServer即可
    
3.  每个用户有自己的家目录，且只能访问自己的家目录;
    
    1). 添加用户时，为用户新加一个HOME目录，该目录只能自己访问，且只能在自己的HOME目录下活动:
        
        ```python
        os.popen("mkdir%s"%user_home_path)
        ```
        
    2). 参考Linux，在home目录下存放各个用户的家目录。用户的家目录可以用os.path.join(HOME_PATH, xxx)来拼接(xxx为家目录)，然后就可以创建用户的家目录了。
        
        ```python
        BASE_DIR=os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
        HOME_PATH=os.path.join(BASE_DIR,"home")
        print(HOME_PATH)
        ```
    
    3). 访问HOME目录，即在HOME目录下使用cd命令即可，可以让用户一登录就处于HOME目录下自己的文件中。
    
4. 配额问题：暂时不进行处理

5. 实现cd命令

6. 实现ls命令

7. 允许上传和下载文件，并保证文件的一致性md5：
    
    使用socket进行数据传输，并进行MD5验证，不过，如果传输的文件很大的话，md5验证会话费很长时间。
    
8. 文件传输过程中显示进度条：
    
    将接受的数据大小除以文件总大小即可计算出当前已接受的文件百分比。

9. 断点续传：
    
    对中断传输的文件，再次进行下载时，先比较文件大小，小的一方将当前文件大小发送给大的一方，大的一方打开文件后使用seek定位到上次传输结束的位置继续发送文件。



参考：
https://www.cnblogs.com/wj-1314/p/8707787.html

https://blog.csdn.net/qq_34964399/article/details/79248266

https://www.cnblogs.com/shengyang17/p/8901266.html


**编写过程中想到的方案**

1. 用户信息可以使用Base64进行加密，这样在服务器端可以进行解密后查看，不像使用md5无法解密查看内容
2. 传输文件时，如果两端有同名文件，应该比较相同文件中小文件的md5与大文件中小文件长度部分的md5值，来判断二者的前一部分是否相同，
相同的，断点续传；不同的话，重新发送

    